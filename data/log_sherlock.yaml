# Copyright 2024 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


buffers: {
    size_kb: 63488
    fill_policy: RING_BUFFER
}
buffers: {
    size_kb: 2048
    fill_policy: DISCARD
}

data_sources: {
  config {
      name: "dev.v8.code"
      target_buffer: 0
      v8_config {
          log_script_sources: true
      }
  }
}
data_sources: {
    config {
        name: "android.packages_list"
        target_buffer: 1
    }
}
data_sources: {
    config {
        name: "linux.process_stats"
        target_buffer: 1
        process_stats_config {
            proc_stats_poll_ms: 1000
        }
    }
}
data_sources: {
  config {
      name: "linux.ftrace"
        target_buffer: 0
        ftrace_config: {
            buffer_size_kb: 16384
            drain_period_ms: 250
            ftrace_events: "sched/sched_process_exec"
            ftrace_events: "sched/sched_process_exit"
            ftrace_events: "sched/sched_process_fork"
        }  
  }   
}
data_sources: {
    config {
        name: "org.chromium.trace_event"
        chrome_config {
            trace_config: "{\"record_mode\":\"record-until-full\",\"included_categories\":[\"netlog\"],\"excluded_categories\":[\"*\"],\"memory_dump_config\":{}}"
            privacy_filtering_enabled: false
            client_priority: USER_INITIATED
        }
    }
}
data_sources: {
    config {
        name: "track_event"
        chrome_config {
            trace_config: "{\"record_mode\":\"record-until-full\",\"included_categories\":[\"netlog\"],\"excluded_categories\":[\"*\"],\"memory_dump_config\":{}}"
            privacy_filtering_enabled: false
            client_priority: USER_INITIATED
        }
        track_event_config {
            disabled_categories: "*"
            enabled_categories: "netlog"
            enabled_categories: "__metadata"
            timestamp_unit_multiplier: 1000
            filter_debug_annotations: false
            enable_thread_time_sampling: true
            filter_dynamic_event_names: false
        }
    }
}
data_sources: {
    config {
        name: "org.chromium.trace_metadata"
        chrome_config {
            trace_config: "{\"record_mode\":\"record-until-full\",\"included_categories\":[\"netlog\"],\"excluded_categories\":[\"*\"],\"memory_dump_config\":{}}"
            privacy_filtering_enabled: false
            client_priority: USER_INITIATED
        }
    }
}
# 24 hours trace
duration_ms: 86400000
write_into_file: true
file_write_period_ms: 2500

# 1 gigabyte maximum file size
max_file_size_bytes: 1073741824
flush_period_ms: 20000